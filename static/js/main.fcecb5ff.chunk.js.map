{"version":3,"sources":["../../src/use-dropdown-menu.ts","app.tsx","index.tsx"],"names":["useRef","setIsOpen","e","App","useDropdownMenu","buttonProps","itemProps","isOpen","className","type","id","role","href","onClick","alert","target","rel","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.fcecb5ff.chunk.js","sourcesContent":["\"use strict\";\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nfunction useDropdownMenu(itemCount) {\n    var _a = react_1.useState(false), isOpen = _a[0], setIsOpen = _a[1];\n    var currentFocusIndex = react_1.useRef(null);\n    var firstRun = react_1.useRef(true);\n    var clickedOpen = react_1.useRef(false);\n    var buttonRef = react_1.useRef(null);\n    var itemRefs = react_1.useRef(__spreadArrays(Array(itemCount)).map(function () { return react_1.createRef(); }));\n    var isKeyboardEvent = function (e) {\n        return e.key !== undefined;\n    };\n    var moveFocus = function (itemIndex) {\n        var _a;\n        currentFocusIndex.current = itemIndex;\n        (_a = itemRefs.current[itemIndex].current) === null || _a === void 0 ? void 0 : _a.focus();\n    };\n    react_1.useEffect(function () {\n        if (firstRun.current) {\n            firstRun.current = false;\n            return;\n        }\n        if (isOpen && !clickedOpen.current) {\n            moveFocus(0);\n        }\n        else if (!isOpen) {\n            clickedOpen.current = false;\n        }\n    }, [isOpen]);\n    react_1.useEffect(function () {\n        var handleEveryClick = function (event) {\n            if (!isOpen) {\n                return;\n            }\n            setTimeout(function () {\n                if (!(event.target instanceof Element)) {\n                    return;\n                }\n                if (event.target.closest('[role=\"menu\"]') instanceof Element) {\n                    return;\n                }\n                setIsOpen(false);\n            }, 10);\n        };\n        document.addEventListener('click', handleEveryClick);\n        return function () { return document.removeEventListener('click', handleEveryClick); };\n    }, [isOpen]);\n    var buttonListener = function (e) {\n        if (isKeyboardEvent(e)) {\n            var key = e.key;\n            if (!['Enter', ' ', 'Tab', 'ArrowDown'].includes(key)) {\n                return;\n            }\n            if ((key === 'Tab' || key === 'ArrowDown') && clickedOpen.current && isOpen) {\n                e.preventDefault();\n                moveFocus(0);\n            }\n            else if (key !== 'Tab') {\n                e.preventDefault();\n                setIsOpen(true);\n            }\n        }\n        else {\n            clickedOpen.current = !isOpen;\n            setIsOpen(!isOpen);\n        }\n    };\n    var itemListener = function (e) {\n        var _a;\n        var key = e.key;\n        if (!['Tab', 'Shift', 'Enter', 'Escape', 'ArrowUp', 'ArrowDown'].includes(key)) {\n            return;\n        }\n        var newFocusIndex = currentFocusIndex.current;\n        if (key === 'Escape') {\n            setIsOpen(false);\n            (_a = buttonRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n            return;\n        }\n        else if (key === 'Tab') {\n            setIsOpen(false);\n            return;\n        }\n        else if (key === 'Enter') {\n            if (!e.currentTarget.href) {\n                e.currentTarget.click();\n            }\n            setIsOpen(false);\n            return;\n        }\n        if (newFocusIndex !== null) {\n            if (key === 'ArrowUp') {\n                newFocusIndex -= 1;\n            }\n            else if (key === 'ArrowDown') {\n                newFocusIndex += 1;\n            }\n            if (newFocusIndex > itemRefs.current.length - 1) {\n                newFocusIndex = 0;\n            }\n            else if (newFocusIndex < 0) {\n                newFocusIndex = itemRefs.current.length - 1;\n            }\n        }\n        if (newFocusIndex !== null) {\n            moveFocus(newFocusIndex);\n        }\n    };\n    var buttonProps = {\n        onKeyDown: buttonListener,\n        onClick: buttonListener,\n        tabIndex: 0,\n        ref: buttonRef,\n        role: 'button',\n        'aria-haspopup': true,\n        'aria-expanded': isOpen,\n    };\n    var itemProps = __spreadArrays(Array(itemCount)).map(function (ignore, index) { return ({\n        onKeyDown: itemListener,\n        tabIndex: -1,\n        role: 'menuitem',\n        ref: itemRefs.current[index],\n    }); });\n    return { buttonProps: buttonProps, itemProps: itemProps, isOpen: isOpen, setIsOpen: setIsOpen };\n}\nexports.default = useDropdownMenu;\n//# sourceMappingURL=use-dropdown-menu.js.map","// Imports\nimport React from 'react';\nimport './app.css';\nimport useDropdownMenu from 'react-accessible-dropdown-menu-hook';\n\n// Functional component\nconst App: React.FC = () => {\n\t// Use the Hook\n\tconst { buttonProps, itemProps, isOpen } = useDropdownMenu(3);\n\n\t// Return JSX\n\treturn (\n\t\t<main className='app'>\n\t\t\t<h1>React Accessible Dropdown Menu Hook</h1>\n\t\t\t<h2>A simple Hook for creating fully accessible dropdown menus in React</h2>\n\n\t\t\t<button {...buttonProps} type='button' id='menu-button'>\n\t\t\t\t<span>Try me!</span>\n\t\t\t\t<i className='fal fa-angle-down' />\n\t\t\t</button>\n\n\t\t\t<div className={isOpen ? 'visible' : ''} role='menu' id='menu'>\n\t\t\t\t<a {...itemProps[0]} href='https://github.com/sparksuite/react-accessible-dropdown-menu-hook' id='menu-item-1'>\n\t\t\t\t\t<i className='fab fa-github fa-fw' />\n\t\t\t\t\tView on GitHub\n\t\t\t\t</a>\n\n\t\t\t\t<a {...itemProps[1]} href='https://www.npmjs.com/package/react-accessible-dropdown-menu-hook' id='menu-item-2'>\n\t\t\t\t\t<i className='fab fa-npm fa-fw' />\n\t\t\t\t\tView on npm\n\t\t\t\t</a>\n\n\t\t\t\t<a {...itemProps[2]} onClick={() => alert('Click!')} id='menu-item-3'>\n\t\t\t\t\t<i className='fas fa-mouse fa-fw' />\n\t\t\t\t\tItem with click handler\n\t\t\t\t</a>\n\t\t\t</div>\n\n\t\t\t<h3>Behavior:</h3>\n\n\t\t\t<ul>\n\t\t\t\t<li>The menu can be revealed by clicking the button, or by focusing the button and pressing enter / space</li>\n\t\t\t\t<li>If the menu is revealed with the keyboard, the first menu item is automatically focused</li>\n\t\t\t\t<li>If the menu is revealed with the mouse, the first menu item can be focused by pressing tab / arrow down</li>\n\t\t\t\t<li>\n\t\t\t\t\t<em>Once focus is in the menu…</em>\n\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tThe up / down arrow keys allow for navigation through the menu items (including wrapping from first to\n\t\t\t\t\t\t\tlast and vice versa)\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>Pressing tab will close the menu and move the focus to the next focusable element</li>\n\t\t\t\t\t\t<li>Pressing shift-tab will close the menu and move the focus to the previous focusable element</li>\n\t\t\t\t\t\t<li>Pressing escape will close the menu and return the focus to the button</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tPressing enter will activate that item and close the menu (whether itʼs a link or has a click handler\n\t\t\t\t\t\t\tattached)\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t</ul>\n\n\t\t\t<div className='footer'>\n\t\t\t\t<a href='https://github.com/sparksuite/react-accessible-dropdown-menu-hook' id='first-footer-link'>\n\t\t\t\t\tView on GitHub <i className='fad fa-external-link' />\n\t\t\t\t</a>\n\t\t\t\t<a href='https://www.npmjs.com/package/react-accessible-dropdown-menu-hook'>\n\t\t\t\t\tView on npm <i className='fad fa-external-link' />\n\t\t\t\t</a>\n\t\t\t\tBuilt by&nbsp;\n\t\t\t\t<a href='https://www.sparksuite.com' target='_blank' rel='noopener noreferrer'>\n\t\t\t\t\tSparksuite <i className='fad fa-external-link' />\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</main>\n\t);\n};\n\nexport default App;\n","// Imports\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './app';\n\n// Render\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}